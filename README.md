# 👕 AI Closet Weather – 스마트 옷장 관리 시스템 (Capstone Project)

라즈베리파이 + 카메라 + ONNX AI 모델을 활용하여  
**옷을 자동 인식 → 세부 종류 분류 → 저장 → UI 기반 필터링 조회**까지  
완전히 자동화된 AI 기반 옷장 관리 시스템입니다.

본 프로젝트는 객체 인식, 분류 모델, UI, 데이터 저장 구조를 모두 직접 설계한 통합 시스템입니다.

👉 **전체 PDF 문서 보기**  
[📄 AI_closet_weather.pdf](./AI_closet_weather.pdf)



---

## 📸 프로젝트 개요

### ✔ 핵심 목표 (p.3)
- 카메라로 옷을 자동 인식  
- 상의 / 하의 / 아우터 분류  
- 세부 종류(셔츠/맨투맨/니트/슬랙스 등) 자동 분류  
- 사용자 UI로 필터링하여 옷장처럼 조회  
- CSV + 이미지로 데이터 저장 및 불러오기  
- 직관적인 UI 제공

### ✔ 시스템 전체 블록도 (PDF p.3 이미지 기반)
- **모드 0: 인식 모드**
  - 카메라 → YOLOv5 ONNX → 옷 탐지  
  - 객체 이미지 버퍼(list)에 저장  

- **모드 1: 옷장 보기 모드**
  - 버퍼의 이미지를 상세 분류 모델로 재분류  
  - ID 생성 후 데이터 저장  
  - 필터링 UI로 조회 가능  

---

# 🧩 주요 기능 설명

## 1️⃣ 모드 0 – 객체 인식 (Detector 클래스)
 

YOLOv5 ONNX 모델을 Raspberry Pi에서 실행해 옷을 탐지.

### ✔ 알고리즘 특징
- 3프레임 이상 연속 감지된 객체만 저장 → 오탐 방지  
- 객체 크기(size)가 “목표 크기(bestSize=350)에 가장 가까운 이미지”만 최종 저장  
- 감지 안 되면 count 감소 → count = 0 일 때 저장 상태로 전환  
- 자른 이미지(crop)는 항상 정사각형으로 맞춤  
- 이미지 좌표가 프레임 밖으로 벗어나면 자동 교정(보정 코드 포함)

### ✔ Detector 출력값
[obj(x,y,w,h,conf,class), 정사각형 이미지]


---

## 2️⃣ 모드 전환 시 – ClothesSorter 상세 분류 (상세 분류 모델)


YOLO로 탐지된 옷을 세부 모델(상의/하의/아우터)로 다시 분류:

### ✔ 상의 분류
- 셔츠, 스웨터/니트, 맨투맨/후드티, 반팔 티셔츠

### ✔ 하의 분류
- 청바지, 반바지, 슬랙스/면바지, 스웨트팬츠, 카고바지

### ✔ 아우터 분류
- 점퍼, 패딩, 바람막이, 코트, 후리스, 자켓

### ✔ ID 생성 방식
PDF p.7 참고:
YYMMDDhhmmss + 종류코드(1/2/3) + 세부종류 인덱스
예: 24120713435913



---

## 3️⃣ 모드 1 – 옷장 조회 UI (Tkinter)

UI는 모드 0 / 모드 1을 완전히 다른 화면처럼 구성.

### ✔ 제공 기능
- 계절 필터: 봄·가을 / 여름 / 겨울  
- 종류 필터: 상의 / 하의 / 아우터  
- 상황 필터: 편한 옷 / 격식 / 일상  
- 스크롤 가능한 옷 목록  
- 이미지 + ID + 종류 + 상세종류 + 위치(안/밖) 표시  
- 필터 버튼으로 즉시 조건 검색  

### ✔ UI 화면 예 (PDF 이미지 기반)
- 모드 0: 실시간 카메라 + 감지 로그 + 버퍼 시각화  
- 모드 1: 리스트 기반 옷장 보기  

---

# 💾 데이터 저장 구조


### ✔ 저장 위치

datas/clothes_data (CSV)
datas/imgs/{id}.jpg


### ✔ CSV 저장 형태

| ID | 안에? | 종류 | 세부 종류 | 이미지경로 |
|----|-------|-------|------------|------------|

프로그램 시작 시 CSV를 불러와 이미지까지 다시 결합하여 메모리 리스트로 복원.

---

# ⚙ 사용 기술 스택


### ✔ Software
- Python  
- Tkinter(UI)  
- YOLOv5 → ONNX 변환  
- PyTorch  
- ONNX Runtime  
- OpenCV  
- Picamera2  
- Roboflow(라벨링)

### ✔ Hardware
- Raspberry Pi  
- 카메라 모듈  
- 터치스크린 LCD  
- 데스크탑 GPU(학습용)

---

# 🧪 AI 모델 학습 과정


### ✔ 객체 인식 모델(YOLOv5)
- 총 401장의 직접 촬영/캡쳐 이미지  
- 라벨링 후 Data Augmentation → 4,364장  
- Best Setting:

epochs: 150
batch: 4

- ONNX 변환 후 Raspberry Pi에서 실행

### ✔ 분류 모델
- 인터넷 크롤링으로 세부 종류 이미지 수집  
- PyTorch로 학습 후 ONNX 변환  
- 상의 / 하의 / 아우터 각각 모델 사용

---

# 🧠 알고리즘 요약

## ✔ Detector 저장 알고리즘 (PDF p.6 설명 기반)

if 객체감지:
cnt += 1
if cnt >= 3:
저장 가능 상태
기존 이미지와 비교 → bestsize에 더 가까우면 교체
else:
cnt -= 1
if cnt == 0 and 저장 가능:
버퍼에 최종 객체 추가
임시 이미지 초기화




## ✔ 필터링 알고리즘 (PDF p.8)
- 계절 / 종류 / 상황 필터는 각각 다른 리스트 기반 매핑  
- “모두”는 index=0 처리  
- 세부 종류 문자열이 필터 리스트에 포함되면 결과에 추가  

---

# 🖥 전체 코드 구조


## ✔ 필터링 알고리즘 (PDF p.8)
- 계절 / 종류 / 상황 필터는 각각 다른 리스트 기반 매핑  
- “모두”는 index=0 처리  
- 세부 종류 문자열이 필터 리스트에 포함되면 결과에 추가  

---

# 🖥 전체 코드 구조
main.py # 전체 시스템 제어
camera.py # Picamera2로 이미지 캡처
detect.py # YOLO ONNX 추론 + crop
sorter.py # 세부 분류 모델 + ID 생성
ui.py # Tkinter UI (모드0/1)
onnx_run.py # ONNX Runtime 기반 분류 모델 실행


---

# 🧩 한계 및 개선 방안
 

### ✔ 한계
- Raspberry Pi 성능으로 YOLO 추론이 느려 FPS가 0.7초 수준  
- 다양한 환경에서 인식 정확도 100%는 어려움  
- 분류 모델이 단순 조건 기반이라 정교함 부족

### ✔ 개선 아이디어
- 서버 기반 원격 추론  
- 데이터셋 확장 및 재학습  
- 색상 추출 및 추천 알고리즘 추가  
- 사용자 스타일 기반 추천 시스템 구현

---

# 🙋 팀원 역할 (p.2 요약)

| 이름 | 역할 |
|------|------|
| 유ㅇ훈 | 데이터 저장/불러오기, 모델 학습, 모델 활용 코드, UI, 통합 |
| 김ㅇ빈 | UI 개발, 코드 통합 |
| 서ㅇ솔 | 데이터 수집, 라벨링, 분류 모델 학습 |

---

# 🎉 결론

AI Closet Weather 프로젝트는  
**AI 객체 인식 + 세부 분류 모델 + UI 설계 + 데이터 저장 구조**를 모두 독자적으로 구현한 종합 프로젝트입니다.

GitHub 포트폴리오에서 강력한 AI·IoT 기반 프로젝트로 활용할 수 있습니다.

---



